#' @title Stem V
#' @return Stem V
#' @param p01 Stem Spec
#' @param p02 Stem A
#' @param p03 Stem H
#' @param p04 Stem T
mdl_V_144 <- function(p01, p02, p03, p04){
	xmdl.1<-function(p02, p03, p04){
		c05 = -0.3231
		c18 = 1.801
		c17 = -0.133
		c16 = 2
		c15 = 1741
		c14 = 0.041
		c13 = 10223
		c12 = -856.62
		c11 = 29.804
		c10 = -.3474
		c02 = 68.016
		c03 = -362.16
		c04 = 0.0
		c06 = 24.719
		c07 = -591.88
		c08 = 6178.7
		c09 = 0.0
		c01 = -.6203
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}
	xmdl.2<-function(p02, p03, p04){
		c18 = 0.588
		c17 = 0.24
		c16 = 1
		c15 = 10.44
		c14 = 0.344
		c13 = -13950
		c12 = 2004.1
		c11 = -74.889
		c10 = .8885
		c02 = 43.62
		c03 = -116.64
		c04 = 0.0
		c05 = 0.0
		c06 = -3.4704
		c07 = 221.02
		c08 = -1151.4
		c09 = 0.0
		c01 = 0.0
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}
	xmdl.3<-function(p02, p03, p04){
		c18 = 1.801
		c17 = -0.133
		c16 = 2
		c15 = 1741
		c14 = 0.041
		c13 = 14038
		c12 = -2095
		c11 = 129.5
		c10 = -3.3471
		c02 = 30.151
		c03 = -216.75
		c04 = 0.0
		c05 = 0.0
		c06 = 1.2617
		c07 = -27.129
		c08 = 2158.2
		c09 = 0.0307
		c01 = 0.0
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}
	xmdl.4<-function(p02, p03, p04){
		c19 = 0.0
		c18 = 1.801
		c17 = -0.133
		c16 = 2
		c15 = 1741
		c14 = 0.041
		c13 = -16779
		c12 = 3475.8
		c11 = -229.79
		c10 = 6.467
		c02 = 7.7533
		c03 = -0.6404
		c04 = -0.1184
		c05 = 12.026
		c06 = -443.8
		c07 = 7042
		c08 = -38110
		c09 = -0.0659
		c01 = 0.6765
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}
	xmdl.6<-function(p02, p03, p04){
		c18 = 1.801
		c17 = -0.133
		c16 = 2
		c15 = 1741
		c14 = 0.041
		c13 = -29479
		c12 = 3649
		c11 = -136.67
		c10 = 1.6594
		c02 = -98.31
		c03 = 1365.4
		c04 = 0.0
		c05 = 1.9631
		c06 = -162.01
		c07 = 4332.8
		c08 = -32957
		c09 = 0.0
		c01 = 2.308
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}
	xmdl.7<-function(p02, p03, p04){
		c18 = 1.801
		c17 = -0.133
		c16 = 2
		c15 = 1741
		c14 = 0.041
		c13 = 6798.5
		c12 = -968.63
		c11 = 74.63
		c10 = -2.4449
		c09 = 0.028
		c02 = -27.487
		c03 = 380.14
		c04 = 0.0691
		c05 = -6.1085
		c06 = 190.47
		c07 = -2504.5
		c08 = 14064
		c01 = 1.6796
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}
	xmdl.8<-function(p02, p03, p04){
		c18 = 1.801
		c17 = -0.133
		c16 = 2
		c15 = 1741
		c14 = 0.041
		c13 = 4450.4
		c12 = -428.5
		c11 = 18.97
		c10 = -0.2532
		c04 = 0.0
		c05 = 0.0
		c06 = 0.5323
		c07 = -29.907
		c08 = 1667.7
		c09 = 0.0
		c01 = 1.5616
		c02 = -113.61
		c03 = 2593.7
		ipf1 =  iif(p02 <30,c018,iif(p02 >100,c14,c15/p02^c016+c017))
		ipf2 = ((((c04*p03+c05)*p03+c06)*p03+c07)*p03+c08)/100000
		ipf3 = ((((c09*p03+c10)*p03+c11)*p03+c12)*p03+c13)/1000
		((c01 * p03+c02) * p03+c03) * ipf2 * ipf3 * (1-exp(-ipf2 * p02))^(ipf3-1) * exp(-ipf2 * p02) * (((ipf1+1)-ipf1 * p04) * p04)
	}

	with(data.frame( p01, p02, p03, p04 ),
		ifelse(p01 %in% c('LH','MA'), xmdl.1(p02, p03, p04), 
		ifelse(p01 %in% c('TS','NU','KU'), xmdl.2(p02, p03, p04), 
		ifelse(p01 %in% c('LM','KS'), xmdl.3(p02, p03, p04), 
		ifelse(p01 %in% c('PN','HB'), xmdl.4(p02, p03, p04), 
		ifelse(p01 %in% c('TL','RE','LV'), xmdl.6(p02, p03, p04), 
		ifelse(p01 %in% c('TA'), xmdl.7(p02, p03, p04), 
		ifelse(p01 %in% c('SA'), xmdl.8(p02, p03, p04), 
		NA
		))))))))
}
